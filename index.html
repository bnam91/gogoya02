<!DOCTYPE html>
<html>
<head>
    <!-- 기본 메타데이터 및 스타일시트 -->
    <title>gogoya v0.5.9</title>
    <!-- Google Fonts - Noto Sans KR 폰트 로드 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100..900&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 커스텀 스타일시트 -->
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="src/styles/vendor.css">
    <link rel="stylesheet" href="src/styles/toast.css">
    <link rel="stylesheet" href="src/styles/vendor_dashboard/dashboard.css">
    <link rel="stylesheet" href="src/styles/vendor_request/request.css">
    <link rel="stylesheet" href="src/styles/vendor_campaign/campaign.css">
    <link rel="stylesheet" href="src/styles/vendor_seller_analysis/seller_analysis.css">
    <link rel="stylesheet" href="src/css/vendor_sellerMatch/sellerMatch.css">
</head>
<body>
    <!-- 메인 컨테이너 -->
    <div class="container">
        <!-- 좌측 사이드바 메뉴 -->
        <div class="sidebar">
            <!-- 로고 버튼 -->
            <div class="logo-container">
                <img src="src/images/logo.svg" alt="로고" class="logo" data-page="home">
            </div>
            <ul class="menu-list">
                <!-- 홈 메뉴 아이템 -->
                <li class="menu-item" data-page="home">
                    <div class="menu-header">
                        <span>홈</span>
                    </div>
                </li>
                <!-- 벤더 메뉴 아이템 (하위 메뉴 포함) -->
                <li class="menu-item">
                    <div class="menu-header">
                        <span>벤더</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <ul class="submenu">
                        <li data-page="vendor/dashboard">대시보드</li>
                        <li data-page="vendor/brandcontact">브랜드 컨택</li>
                        <li data-page="vendor/request">제안서 관리</li>
                        <li data-page="vendor/supplytab">공급가 관리</li>
                        <li data-page="vendor/sellerMatch">셀러매칭</li>
                        <li data-page="vendor/campaign">캠페인 관리</li>
                        <li data-page="vendor/sellerAnalysis">셀러분석</li>
                    </ul>
                </li>
                <!-- 관리자 메뉴 아이템 (하위 메뉴 포함) -->
                <li class="menu-item">
                    <div class="menu-header">
                        <span>관리자</span>
                        <span class="toggle-icon">▼</span>
                    </div>
                    <ul class="submenu">
                        <li data-page="admin/users">사용자 관리</li>
                        <li data-page="admin/settings">시스템 설정</li>
                    </ul>
                </li>
            </ul>
        </div>
        <!-- 메인 콘텐츠 영역 -->
        <div class="content" id="content">
            <!-- 홈 페이지 콘텐츠 -->
            <div id="home-content" class="content-section active">
                대기중입니다
            </div>
            <!-- 대시보드탭 콘텐츠 -->
            <div id="dashboard-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">대시보드</span>
                </div>
                <!-- 대시보드 컨테이너 (3단 레이아웃) -->
                <div class="dashboard-container" id="dashboard-container">
                    <!-- 여기에 vendor_dashboard.html의 내용이 동적으로 로드됩니다 -->
                </div>
            </div>
            <!-- 벤더 페이지 콘텐츠 -->
            <div id="vendor-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">브랜드 컨택</span>
                </div>
                <!-- 벤더 컨테이너 (3단 레이아웃) -->
                <div class="vendor-container">
                    <!-- 좌측: 데이터 리스트 -->
                    <div class="vendor-left">
                        <div id="vendor-data-list" class="card-container" style="height: 100%; overflow-y: auto;">
                        </div>
                    </div>
                    <!-- 우측: 상세 정보 -->
                    <div class="vendor-right">
                        <p>상세 정보가 여기에 표시됩니다.</p>
                    </div>
                    <!-- 하단: 추가 정보 -->
                    <div class="vendor-extra">
                        <div class="extra-content">
                            <h3>추가 정보</h3>
                            <p>여기에 추가 정보가 표시됩니다.</p>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 제안서 관리 콘텐츠 -->
            <div id="request-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">제안서 관리</span>
                </div>
            </div>
            <!-- 공급가 관리 콘텐츠 -->
            <div id="supplytab-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">공급가 관리</span>
                </div>
                <div class="supplytab-container">
                    대기중입니다
                </div>
            </div>
            <!-- 셀러매칭 콘텐츠 추가 -->
            <div id="sellerMatch-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">셀러매칭</span>
                </div>
                <div class="sellerMatch-container">
                    <div class="sellerMatch-content">
                        <div class="sellerMatch-left-panel">
                            <div id="sellerMatch-left-content">
                                <!-- 왼쪽 패널 내용 -->
                            </div>
                        </div>
                        <div class="sellerMatch-center-panel">
                            <div id="sellerMatch-center-content">
                                <!-- 중앙 패널 내용 -->
                            </div>
                        </div>
                        <div class="sellerMatch-right-panel">
                            <div id="sellerMatch-right-content">
                                <!-- 오른쪽 패널 내용 -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 캠페인 관리 콘텐츠 추가 -->
            <div id="campaign-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">캠페인 관리</span>
                </div>
                <div class="campaign-container">
                    대기중입니다
                </div>
            </div>
            <!-- 셀러분석 탭 콘텐츠 -->
            <div id="sellerAnalysis-content" class="content-section">
                <!-- 브레드크럼 네비게이션 -->
                <div class="breadcrumb">
                    <span class="breadcrumb-item">벤더</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">셀러분석</span>
                </div>
                <!-- 셀러분석 컨테이너 -->
                <div class="seller-analysis-container">
                    <!-- HTML이 동적으로 로드됩니다 -->
                </div>
            </div>
            <!-- 관리자 콘텐츠 영역 추가 -->
            <!-- 사용자 관리 콘텐츠 -->
            <div id="users-content" class="content-section">
                <div class="breadcrumb">
                    <span class="breadcrumb-item">관리자</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">사용자 관리</span>
                </div>
                <div class="users-container">
                    대기중입니다
                </div>
            </div>
            <!-- 시스템 설정 콘텐츠 -->
            <div id="settings-content" class="content-section">
                <div class="breadcrumb">
                    <span class="breadcrumb-item">관리자</span>
                    <span class="breadcrumb-separator">/</span>
                    <span class="breadcrumb-item current">시스템 설정</span>
                </div>
                <div class="settings-container">
                    대기중입니다
                </div>
            </div>
        </div>
    </div>
    <!-- 전화 걸기 확인 모달 -->
    <div id="call-confirm-modal" class="modal">
        <div class="modal-content">
            <h3>전화 걸기</h3>
            <p>전화를 걸까요?</p>
            <p class="phone-number"></p>
            <div class="modal-buttons">
                <button class="modal-button confirm">확인</button>
                <button class="modal-button cancel">취소</button>
            </div>
        </div>
    </div>
    <script>
        // 공통으로 사용할 모듈 선언
        const mongo = require('./src/js/mongo');
        const phone = require('./src/js/phone');
        const googleapis = require('googleapis');
        const fs = require('fs');
        const path = require('path');
        
        try {
            const gmailAuth = require('./src/js/vendor_request/gmailAuth');
            window.getGmailCredentials = gmailAuth.getGmailCredentials;
        } catch (error) {
            // 에러 발생 시 조용히 처리
        }
        
        window.mongo = mongo;
        window.phone = phone;
        window.google = googleapis.google;
        window.fs = fs;
        window.path = path;
    </script>

    <!-- 그 다음 각 클래스 파일들을 로드 -->
    <script src="src/js/vendorFilter.js"></script>
    <script src="src/js/vendorCallManager.js"></script>
    <script src="src/js/vendorInfoEditor.js"></script>
    <script src="src/js/vendorCallHistory.js"></script>
    <script src="src/js/vendor_dashboard/dashboard.js"></script>
    <script src="src/js/vendor_request/request.js"></script>

    <!-- 마지막으로 메인 로직을 로드 -->
    <script>
        // 인스턴스 생성
        window.vendorFilter = new VendorFilter();
        window.vendorCallManager = new VendorCallManager();
        window.vendorInfoEditor = new VendorInfoEditor();
        
        // RequestManager 인스턴스는 생성만 하고 초기화는 하지 않음
        window.requestManager = new RequestManager(); // init() 호출 제거
        
        // vendor.js 로드
        const vendor = require('./src/js/vendor');

        // 대시보드 콘텐츠 로드 함수
        async function loadDashboardContent() {
            try {
                const response = await fetch('src/pages/vendor/vendor_dashboard.html');
                const html = await response.text();
                const parser = new DOMParser();
                const doc = parser.parseFromString(html, 'text/html');
                const dashboardContent = doc.querySelector('.dashboard-container');
                document.getElementById('dashboard-container').innerHTML = dashboardContent.innerHTML;
                
                // 대시보드 초기화
                if (window.dashboard) {
                    window.dashboard.init();
                }
            } catch (error) {
                console.error('대시보드 콘텐츠 로드 중 오류 발생:', error);
            }
        }

        // 제안서 관리 콘텐츠 로드 함수
        async function loadRequestContent() {
            try {
                const contentDiv = document.getElementById('request-content');
                
                // request.html이 아직 로드되지 않은 경우에만 로드
                if (!contentDiv.querySelector('.request-container')) {
                    const response = await fetch('src/pages/vendor/request.html');
                    const html = await response.text();
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');
                    const requestContent = doc.querySelector('.request-container');
                    
                    // 브레드크럼 유지하면서 콘텐츠 추가
                    contentDiv.appendChild(requestContent);
                }
                
                // RequestManager가 아직 초기화되지 않은 경우에만 초기화
                if (window.requestManager && !window.requestManager.initialized) {
                    await window.requestManager.init();
                    window.requestManager.initialized = true;
                }
            } catch (error) {
                console.error('제안서 관리 콘텐츠 로드 중 오류 발생:', error);
            }
        }

        // 메뉴 토글 기능 구현
        document.querySelectorAll('.menu-header').forEach(header => {
            header.addEventListener('click', function() {
                const menuItem = this.parentElement;
                const submenu = menuItem.querySelector('.submenu');
                const toggleIcon = menuItem.querySelector('.toggle-icon');
                
                if (submenu) {
                    const isExpanded = submenu.classList.contains('expanded');
                    
                    // 모든 서브메뉴 닫기
                    document.querySelectorAll('.submenu').forEach(menu => {
                        menu.classList.remove('expanded');
                        const icon = menu.parentElement.querySelector('.toggle-icon');
                        if (icon) icon.classList.remove('active');
                    });

                    // 선택된 메뉴만 확장
                    if (!isExpanded) {
                        submenu.classList.add('expanded');
                        if (toggleIcon) toggleIcon.classList.add('active');
                    }
                }
            });
        });

        // 페이지 전환 기능 구현
        document.querySelectorAll('[data-page]').forEach(item => {
            item.addEventListener('click', function() {
                const page = this.dataset.page;
                if (page === 'home') {
                    showContent('home');
                } else if (page === 'vendor/dashboard') {
                    showContent('dashboard');
                    loadDashboardContent();
                } else if (page === 'vendor/brandcontact') {
                    showContent('vendor');
                } else if (page === 'vendor/request') {
                    showContent('request');
                    loadRequestContent();
                } else if (page === 'vendor/supplytab') {
                    showContent('supplytab');
                    if (window.supplyTabManager) {
                        window.supplyTabManager.init();
                    }
                } else if (page === 'vendor/sellerMatch') {
                    showContent('sellerMatch');
                    if (window.sellerMatchManager) {
                        window.sellerMatchManager.init();
                    }
                } else if (page === 'vendor/sellerAnalysis') {
                    showContent('sellerAnalysis');
                    if (window.sellerAnalysisManager) {
                        window.sellerAnalysisManager.init();
                    }
                } else if (page === 'vendor/campaign') {
                    showContent('campaign');
                    if (window.campaignManager) {
                        window.campaignManager.init();
                    }
                } else if (page === 'admin/users') {
                    showContent('users');
                    if (window.usersManager) {
                        window.usersManager.init();
                    }
                } else if (page === 'admin/settings') {
                    showContent('settings');
                    if (window.settingsManager) {
                        window.settingsManager.init();
                    }
                }
            });
        });

        // 콘텐츠 표시 함수
        function showContent(content) {
            // 모든 콘텐츠 섹션 비활성화
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });
            // 선택된 콘텐츠 섹션 활성화
            document.getElementById(content + '-content').classList.add('active');
            
            // 모든 필터 컨테이너 제거
            document.querySelectorAll('.filter-container').forEach(filter => {
                filter.remove();
            });
            
            // 벤더 페이지인 경우 초기화 함수 실행
            if (content === 'vendor') {
                vendor.initVendor();
                vendorFilter.init();
            }
        }
    </script>
    <!-- 공급가 관리 JS 파일 추가 -->
    <script src="src/js/vendor_supplytab/supplytab.js"></script>
    <!-- 셀러매칭 JS 파일 추가 -->
    <script src="src/js/vendor_sellerMatch/sellerMatchFilter.js"></script>
    <script src="src/js/vendor_sellerMatch/sellerMatch.js"></script>
    <!-- 셀러분석 JS 파일 추가 -->
    <script src="src/js/vendor_seller_analysis/sellerAnalysisFilter.js"></script>
    <script src="src/js/vendor_seller_analysis/sellerAnalysis.js"></script>
    <!-- 캠페인 관리 JS 파일 추가 -->
    <script src="src/js/vendor_campaign/campaign.js"></script>
    <!-- 관리자 관련 JS 파일 추가 -->
    <script src="src/js/admin_users/users.js"></script>
    <script src="src/js/admin_settings/settings.js"></script>
    <!-- 계정 정보를 전역 객체에 추가 -->
    <script>
        window.accounts = [
            { id: "bnam91", name: "고야앤드미디어", email: "bnam91@goyamkt.com" },
            { id: "contant01", name: "박슬하(고야앤드미디어)", email: "contant01@goyamkt.com" },
            { id: "jisu04", name: "김지수(고야앤드미디어)", email: "jisu04@goyamkt.com" }
        ];
    </script>
</body>
</html> 